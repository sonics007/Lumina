{% extends "base.html" %}

{% block content %}
<div class="table-container">
    <h2><i class="fas fa-users"></i> Client History</h2>
    <br>
    <table>
        <thead>
            <tr>
                <th>Time</th>
                <th>IP Address</th>
                <th>Action</th>
                <th>Playlist</th>
                <th>Content Watched</th>
                <th>User Agent</th>
            </tr>
        </thead>
        <tbody>
            {% for item in history %}
            <tr>
                <td>{{ item.time }}</td>
                <td>{{ item.ip }}</td>
                <td>
                    <span class="client-status {{ 'status-active' if 'Watch' in item.action else 'status-idle' }}">
                        {{ item.action }}
                    </span>
                </td>
                <td>
                    {% if item.playlist %}
                    <span
                        style="background: var(--accent-color); padding: 2px 5px; border-radius: 4px; font-size: 11px;">{{
                        item.playlist }}</span>
                    {% else %}
                    <span style="color: grey;">-</span>
                    {% endif %}
                </td>
                <td>{{ item.content }}</td>
                <td style="font-size: 11px; color: grey;">{{ (item.user_agent or 'Unknown')[:50] }}...</td>
            </tr>
            {% else %}
            <tr>
                <td colspan="5">No history yet.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}